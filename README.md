# ğŸš€ Saudi Stock AI Advisor

Ù…Ø³ØªØ´Ø§Ø± Ø°ÙƒÙŠ Ù„Ù„Ø£Ø³Ù‡Ù… Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¢Ù„ÙŠ (Machine Learning)

## ğŸ“‹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

- [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©](#Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©)
- [Ø§Ù„Ù…Ø²Ø§ÙŠØ§](#Ø§Ù„Ù…Ø²Ø§ÙŠØ§)
- [Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©](#Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª-Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©)
- [Ø§Ù„ØªØ«Ø¨ÙŠØª](#Ø§Ù„ØªØ«Ø¨ÙŠØª)
- [Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…](#Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…)
- [API Endpoints](#api-endpoints)
- [Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª](#Ù‚Ø§Ø¹Ø¯Ø©-Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)

---

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

Ù†Ø¸Ø§Ù… Ø°ÙƒÙŠ ÙŠÙˆÙØ± ØªÙˆØµÙŠØ§Øª ØªØ¯Ø§ÙˆÙ„ ÙŠÙˆÙ…ÙŠØ© Ù„Ù„Ø£Ø³Ù‡Ù… Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù…:
- **Machine Learning** (Random Forest)
- **Technical Indicators** (RSI, MACD, Bollinger Bands, ATR)
- **Yahoo Finance API** Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

---

## âœ¨ Ø§Ù„Ù…Ø²Ø§ÙŠØ§

- âœ… **ØªÙˆØµÙŠØ§Øª Ø°ÙƒÙŠØ©**: Buy/Sell/Hold Ù…Ø¹ Ù†Ø³Ø¨Ø© Ø«Ù‚Ø©
- âœ… **Ù†Ù‚Ø§Ø· Ø¯Ø®ÙˆÙ„ ÙˆØ®Ø±ÙˆØ¬**: Entry Price, Target Price, Stop Loss
- âœ… **ØªØºØ·ÙŠØ© Ø´Ø§Ù…Ù„Ø©**: 80+ Ø³Ù‡Ù… Ø³Ø¹ÙˆØ¯ÙŠ
- âœ… **ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ**: Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Yahoo Finance
- âœ… **RESTful API**: FastAPI Ù…Ø¹ ØªÙˆØ«ÙŠÙ‚ ØªÙ„Ù‚Ø§Ø¦ÙŠ
- âœ… **Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª**: MySQL (AWS RDS)

---

## ğŸ› ï¸ Ø§Ù„ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©

### Backend
- **FastAPI** - Web Framework
- **Python 3.11+**
- **MySQL** - Database
- **scikit-learn** - Machine Learning
- **pandas & numpy** - Data Processing
- **yfinance** - Stock Data

### Machine Learning
- **Random Forest Classifier**
- **Technical Indicators**: RSI, MACD, SMA, EMA, Bollinger Bands, ATR
- **Features**: 12 Ù…Ø¤Ø´Ø± ÙÙ†ÙŠ

---

## ğŸ“¦ Ø§Ù„ØªØ«Ø¨ÙŠØª

### Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
- Python 3.11+
- MySQL Database (AWS RDS)
- pip3

### 1. Ø§Ø³ØªÙ†Ø³Ø§Ø® Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

```bash
git clone https://github.com/YOUR_USERNAME/saudi-stock-ai.git
cd saudi-stock-ai
```

### 2. ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª

```bash
pip3 install -r requirements.txt
```

### 3. Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

ØªØ£ÙƒØ¯ Ù…Ù†:
- âœ… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª MySQL ØªØ¹Ù…Ù„
- âœ… Security Group ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„Ø§ØªØµØ§Ù„
- âœ… Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ ØµØ­ÙŠØ­Ø© ÙÙŠ `backend/data/database.py`

```python
# backend/data/database.py
self.host = "tradedb.c3o44s2iqqg8.eu-north-1.rds.amazonaws.com"
self.user = "admin"
self.password = "YOUR_PASSWORD"
self.database = "saudi_stock_advisor"
```

### 4. Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„

```sql
-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ù‡Ù…
CREATE TABLE stocks (
    symbol VARCHAR(10) PRIMARY KEY,
    nameAr VARCHAR(100),
    nameEn VARCHAR(100),
    sector VARCHAR(50),
    currentPrice DECIMAL(10,2),
    `change` DECIMAL(10,2),
    changePercent DECIMAL(10,2),
    isActive BOOLEAN DEFAULT 1,
    lastUpdate TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ©
CREATE TABLE historicalDailyPrices (
    id INT AUTO_INCREMENT PRIMARY KEY,
    symbol VARCHAR(10),
    date DATE,
    open DECIMAL(10,2),
    high DECIMAL(10,2),
    low DECIMAL(10,2),
    close DECIMAL(10,2),
    volume BIGINT,
    UNIQUE KEY unique_symbol_date (symbol, date),
    FOREIGN KEY (symbol) REFERENCES stocks(symbol)
);

-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªÙˆØµÙŠØ§Øª
CREATE TABLE recommendations (
    id INT AUTO_INCREMENT PRIMARY KEY,
    symbol VARCHAR(10),
    type ENUM('buy', 'sell', 'hold'),
    entryPrice DECIMAL(10,2),
    targetPrice DECIMAL(10,2),
    stopLoss DECIMAL(10,2),
    confidence DECIMAL(5,2),
    analysis TEXT,
    status VARCHAR(20) DEFAULT 'active',
    createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (symbol) REFERENCES stocks(symbol)
);

-- Ø¬Ø¯ÙˆÙ„ Ù…Ù„Ø®Øµ Ø§Ù„Ø³ÙˆÙ‚
CREATE TABLE marketSummary (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tasiIndex DECIMAL(10,2),
    tasiChange DECIMAL(10,2),
    tasiChangePercent DECIMAL(5,2),
    stocksUp INT,
    stocksDown INT,
    stocksUnchanged INT,
    totalRecommendations INT,
    lastUpdate TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## ğŸš€ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### 1. Ø³Ø­Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Yahoo Finance

```bash
python3 python_scripts/fetch_stock_data.py
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
- Ø¥Ø¶Ø§ÙØ© 80+ Ø³Ù‡Ù… Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- Ø¬Ù„Ø¨ Ø¢Ø®Ø± Ø³Ù†ØªÙŠÙ† Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ©
- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠØ©

### 2. ØªØ¯Ø±ÙŠØ¨ Ù†Ù…ÙˆØ°Ø¬ ML

```bash
python3 python_scripts/train_model.py
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø©:**
- ØªØ¯Ø±ÙŠØ¨ Random Forest Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ©
- Ø­ÙØ¸ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙÙŠ `/tmp/stock_model.pkl`
- Ø¹Ø±Ø¶ Ø¯Ù‚Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ§Ù„Ù…Ù‚Ø§ÙŠÙŠØ³

### 3. ØªØ´ØºÙŠÙ„ FastAPI Server

```bash
cd backend
python3 main.py
```

**Ø£Ùˆ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… uvicorn:**

```bash
uvicorn backend.main:app --host 0.0.0.0 --port 8000
```

**Ø£Ùˆ ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©:**

```bash
nohup python3 backend/main.py > api.log 2>&1 &
```

### 4. Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ù€ API

- **API**: http://YOUR_SERVER_IP:8000
- **Docs**: http://YOUR_SERVER_IP:8000/docs
- **Health**: http://YOUR_SERVER_IP:8000/api/health

---

## ğŸ“¡ API Endpoints

### Health Check
```bash
GET /api/health
```

**Response:**
```json
{
  "status": "healthy",
  "database": "connected",
  "model": "loaded",
  "timestamp": "2025-12-29T10:00:00"
}
```

### Get Stocks
```bash
GET /api/stocks?limit=100&sector=Ø§Ù„Ø¨Ù†ÙˆÙƒ
```

**Response:**
```json
{
  "count": 10,
  "stocks": [
    {
      "symbol": "1120",
      "nameAr": "Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ",
      "nameEn": "Al Rajhi Bank",
      "sector": "Ø§Ù„Ø¨Ù†ÙˆÙƒ",
      "currentPrice": 95.50,
      "change": 1.20,
      "changePercent": 1.27
    }
  ]
}
```

### Get Stock Details
```bash
GET /api/stocks/1120
```

**Response:**
```json
{
  "stock": {...},
  "history": [...]
}
```

### Get Recommendations
```bash
GET /api/recommendations?limit=50
```

**Response:**
```json
{
  "count": 20,
  "recommendations": [
    {
      "symbol": "1120",
      "nameAr": "Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ",
      "type": "buy",
      "entryPrice": 93.59,
      "targetPrice": 100.28,
      "stopLoss": 92.62,
      "confidence": 78.50,
      "analysis": "RSI: 45.2, MACD: 0.85",
      "createdAt": "2025-12-29 08:00:00"
    }
  ]
}
```

### Generate Recommendations
```bash
POST /api/recommendations/generate?limit=20
```

**Response:**
```json
{
  "generated": 18,
  "total_stocks": 20,
  "errors": []
}
```

### Market Summary
```bash
GET /api/market-summary
```

### Get Sectors
```bash
GET /api/sectors
```

---

## ğŸ—„ï¸ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### Ø§Ù„Ø§ØªØµØ§Ù„

```python
from backend.data.database import Database

db = Database()
stocks = db.get_all_stocks()
db.close()
```

### Ø§Ù„Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ØªØ§Ø­Ø©

```python
# Ø§Ù„Ø£Ø³Ù‡Ù…
db.get_all_stocks()
db.get_stock_by_symbol(symbol)
db.insert_stock(symbol, name_ar, name_en, sector)
db.update_stock_price(symbol, price, change, change_percent)

# Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ©
db.insert_historical_price(symbol, date, open, high, low, close, volume)
db.get_historical_prices(symbol, limit=100)
db.get_all_historical_data(days=500)

# Ø§Ù„ØªÙˆØµÙŠØ§Øª
db.insert_recommendation(symbol, type, entry_price, target_price, stop_loss, confidence, analysis)
db.get_active_recommendations(limit=50)
db.delete_old_recommendations(days=7)
```

---

## ğŸ“Š Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹

```
saudi-stock-ai/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â””â”€â”€ database.py          # ÙˆØ­Ø¯Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ ml_model.py          # Ù†Ù…ÙˆØ°Ø¬ ML
â”‚   â””â”€â”€ main.py                  # FastAPI Application
â”œâ”€â”€ python_scripts/
â”‚   â”œâ”€â”€ saudi_stocks_list.py     # Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ù‡Ù…
â”‚   â”œâ”€â”€ fetch_stock_data.py      # Ø³Ø­Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
â”‚   â””â”€â”€ train_model.py           # ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
â”œâ”€â”€ requirements.txt             # Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
â””â”€â”€ README.md                    # Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù
```

---

## ğŸ”„ Ø§Ù„Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© (Cron)

Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±ÙŠØ¨ØªØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹:

```bash
crontab -e
```

Ø£Ø¶Ù:

```bash
# ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø³Ø§Ø¹Ø©
0 * * * * cd /home/ubuntu/projects/saudi-stock-ai && python3 python_scripts/fetch_stock_data.py

# ØªÙˆÙ„ÙŠØ¯ ØªÙˆØµÙŠØ§Øª ÙŠÙˆÙ…ÙŠØ§Ù‹ (8 ØµØ¨Ø§Ø­Ø§Ù‹)
0 8 * * * curl -X POST http://localhost:8000/api/recommendations/generate?limit=50

# Ø¥Ø¹Ø§Ø¯Ø© ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹ (Ø§Ù„Ø³Ø¨Øª 2 ØµØ¨Ø§Ø­Ø§Ù‹)
0 2 * * 6 cd /home/ubuntu/projects/saudi-stock-ai && python3 python_scripts/train_model.py
```

---

## ğŸ› Ø§Ø³ØªÙƒØ´Ø§Ù Ø§Ù„Ø£Ø®Ø·Ø§Ø¡

### Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

```bash
# ØªØ­Ù‚Ù‚ Ù…Ù† Security Group
# ØªØ£ÙƒØ¯ Ø£Ù† Port 3306 Ù…ÙØªÙˆØ­ Ù„Ù€ IP Ø§Ù„Ø³ÙŠØ±ÙØ±

# Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„
telnet tradedb.c3o44s2iqqg8.eu-north-1.rds.amazonaws.com 3306
```

### Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ØºÙŠØ± Ù…Ø­Ù…Ù‘Ù„

```bash
# ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
python3 python_scripts/train_model.py

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù…Ù„Ù
ls -lh /tmp/stock_model.pkl
```

---

## ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª

- âœ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Yahoo Finance (Ù…Ø¬Ø§Ù†ÙŠØŒ Ù…ØªØ£Ø®Ø± 15-20 Ø¯Ù‚ÙŠÙ‚Ø©)
- âœ… Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
- âš ï¸ Ù„Ù„Ù…Ø¶Ø§Ø±Ø¨Ø© Ø§Ù„Ù„Ø­Ø¸ÙŠØ©ØŒ ØªØ­ØªØ§Ø¬ Real-time API (Tadawul API)

---

## ğŸ“§ Ø§Ù„ØªÙˆØ§ØµÙ„

Ù„Ø£ÙŠ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø£Ùˆ Ù…Ø´Ø§ÙƒÙ„ØŒ Ø§ÙØªØ­ Issue Ø¹Ù„Ù‰ GitHub

---

## ğŸ“„ Ø§Ù„ØªØ±Ø®ÙŠØµ

MIT License

---

**ğŸš€ Ø¨Ø§Ù„ØªÙˆÙÙŠÙ‚ ÙÙŠ Ø§Ù„ØªØ¯Ø§ÙˆÙ„!**
